<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<title data-react-helmet="true">Light Arrow - composable and type safe asynchronous programming for Typescript | Light Arrow</title><meta data-react-helmet="true" property="og:title" content="Light Arrow - composable and type safe asynchronous programming for Typescript | Light Arrow"><meta data-react-helmet="true" name="description" content="Originally published at itnext.io"><meta data-react-helmet="true" property="og:description" content="Originally published at itnext.io"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/light-arrow-docs/img/favicon.ico"><link rel="stylesheet" href="/light-arrow-docs/styles.347a800d.css">
<link rel="preload" href="/light-arrow-docs/styles.5b570e1a.js" as="script">
<link rel="preload" href="/light-arrow-docs/runtime~main.9af3c1b1.js" as="script">
<link rel="preload" href="/light-arrow-docs/main.23c5f3fd.js" as="script">
<link rel="preload" href="/light-arrow-docs/1.8252842a.js" as="script">
<link rel="preload" href="/light-arrow-docs/2.a74b8244.js" as="script">
<link rel="preload" href="/light-arrow-docs/3.80dd5ba5.js" as="script">
<link rel="preload" href="/light-arrow-docs/ccc49370.03171d98.js" as="script">
<link rel="preload" href="/light-arrow-docs/43b07e0d.ede58c70.js" as="script">
<link rel="preload" href="/light-arrow-docs/33c3e163.20790ad5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/light-arrow-docs/"><img class="navbar__logo" src="/light-arrow-docs/img/logo.png" alt="My Site Logo"><strong class="navbar__title">Light Arrow</strong></a><a class="navbar__item navbar__link" href="/light-arrow-docs/docs/Arrow">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/light-arrow-docs/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lauri3new/Light-Arrow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/light-arrow-docs/"><img class="navbar__logo" src="/light-arrow-docs/img/logo.png" alt="My Site Logo"><strong class="navbar__title">Light Arrow</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/light-arrow-docs/docs/Arrow">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/light-arrow-docs/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/lauri3new/Light-Arrow" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_3I7I"><h3 class="sidebarItemTitle_2Dv3">Recent posts</h3><ul class="sidebarItemList_1RlG"><li class="sidebarItem_Hxgp"><a aria-current="page" class="sidebarItemLink_3ppv sidebarItemLinkActive_3XUi" href="/light-arrow-docs/blog/2020/11/06/light-arrow">Light Arrow - composable and type safe asynchronous programming for Typescript</a></li><li class="sidebarItem_Hxgp"><a class="sidebarItemLink_3ppv" href="/light-arrow-docs/blog/2020/05/25/welcome">Welcome</a></li></ul></div></div><div class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_1mse">Light Arrow - composable and type safe asynchronous programming for Typescript</h1><div class="margin-vert--md"><time datetime="2020-11-06T00:00:00.000Z" class="blogPostDate_3bQP">November 6, 2020  · 6 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/lauri3new" target="_blank" rel="noreferrer noopener"><img src="https://avatars2.githubusercontent.com/u/22150857?s=460&amp;u=eeddb00e96c24ccb9a40810a791de544beb4a59b&amp;v=4" alt="Laurence Newman"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/lauri3new" target="_blank" rel="noreferrer noopener">Laurence Newman</a></h4><small class="avatar__subtitle">Founder @ Disaster check in</small></div></div></header><section class="markdown"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="originally-published-at-itnextio"></a>Originally published at <a href="https://itnext.io/light-arrow-composable-and-type-safe-asynchronous-programming-for-typescript-6d6b3380b8d0" target="_blank" rel="noopener noreferrer">itnext.io</a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#originally-published-at-itnextio" title="Direct link to heading">#</a></h3><p><strong>Welcome</strong> to part 1 of this series on using the typescript library Light Arrow for functional programming in Typescript. In part 1 we will cover the Arrow data type. In part 2 we will build a fully type-safe http server.</p><p><em>I am the author of Light Arrow and the project is still in its early stages, please <a href="https://github.com/lauri3new" target="_blank" rel="noopener noreferrer">get in touch</a> if you have any feedback, thanks!</em></p><p align="center"><img src="https://miro.medium.com/max/668/1*db8Jt0pwXFjQaPWTJ8IB6g.png"><br><em>The Arrow data type</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="arrows-and-promises"></a>Arrows and Promises<a aria-hidden="true" tabindex="-1" class="hash-link" href="#arrows-and-promises" title="Direct link to heading">#</a></h3><p>Arrows are data structures that describe asynchronous operations that can succeed with a result value R or error with a value E that depend on some dependencies D. Practically many programs or parts of programs we write fit that description, and often Promises are used for this purpose. However, there are some drawbacks with Promises.</p><p>Lets first look take a look at the Promise Type signature.</p><p><code>Promise&lt;A&gt;</code> represents an asynchronous operation that can succeed with a value of type A. But what about failure? this isn’t represented in the type signature, so we have to look inside the implementation of our particular promise and determine what types our catch error handler needs to handle. Promises are also eagerly evaluated and not referentially transparent which can cause issues when we are refactoring. Referential transparency means we can replace all expressions in our program with the values returned from those expressions, without changing the programs behaviour. For more on potential issues with Promises check out this <a href="https://medium.com/@avaq/broken-promises-2ae92780f33" target="_blank" rel="noopener noreferrer">article</a>.</p><p align="center"><img src="https://miro.medium.com/max/878/0*wLHA2_YwkwxoV3o9"><br><em>Async code and side effects can get complicated… we all know the feeling</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="arrows"></a>Arrows<a aria-hidden="true" tabindex="-1" class="hash-link" href="#arrows" title="Direct link to heading">#</a></h3><p>Arrows have a number of benefits over Promises including referential transparency, typed errors and built in dependency injection capabilities. Each of these are discussed in more detail below. Arrows have a discoverable ‘fluent’ chain-able API, similar to native Promises and Arrays. To see a list of the full API of an Arrow check out the <a href="https://lauri3new.github.io/light-arrow-docs/docs/Arrow/" target="_blank" rel="noopener noreferrer">documentation site</a>.</p><p>More generally than just asynchronous operations, Arrows can be used to model synchronous or asynchronous side effects and compose them together in a type safe way without actually performing any side effects, for this reason data structures such as Arrow are also known as ‘functional effects’. For those familiar with functional programming, Arrows are a kind of ReaderTaskEither.</p><p>Arrows can essentially be seen as useful wrappers around the function type
D =&gt; Promise&lt;Either&lt;E, R&gt;&gt;, that make working with such types more convenient and providing helper methods for composability and convenience. To convert existing data types to Arrows there are several draw functions provided that make this easier. We can also construct Arrows as we would for promises using new Promise, also optionally specifying a &#x27;tidy up&#x27; callback (e.g. to clear up timeouts), see <a href="https://lauri3new.github.io/light-arrow-docs/docs/Arrow/#arrows" target="_blank" rel="noopener noreferrer">here</a> for examples.</p><p align="center"><img src="https://miro.medium.com/max/2000/1*hJhCKM_FQRflyKnHWqUnAA.png"><br><em>An example function `sendEmail` returning an Arrow, depending on a promise based emailService</em></p><p>Let’s now look at some of those benefits I mentioned with examples. In the examples all of the types are inferred but are written out just for demonstration purposes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="error-handling"></a>Error Handling<a aria-hidden="true" tabindex="-1" class="hash-link" href="#error-handling" title="Direct link to heading">#</a></h3><p>Arrows use the Either data type to enable centralised type safe error handling. By tracking the error type we can know from the type signature how our program might fail and cover all cases in the error handling function we pass to the run method (similar to a catch handler we might add at the end of a promise).</p><p align="center"><img src="https://miro.medium.com/max/1400/1*eEfSNcTf0laDlcb_sPhNTQ.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="referential-transparency"></a>Referential Transparency<a aria-hidden="true" tabindex="-1" class="hash-link" href="#referential-transparency" title="Direct link to heading">#</a></h3><p>Arrows won’t actually perform any operation until the run method is called, this means that Arrows have the nice property of being referentially transparent. This means we can refactor expressions involving Arrows, such as calling a function returning an Arrow, and replace them with the value returned without changing the meaning of the program. As it turns out by representing all side effects in our program, whether they are asynchronous or synchronous and fail-able or non fail-able, as Arrows we can maintain referential transparency throughout our program making it easier to reason about.
As our programs side effects are now represented by Arrows, we can compose them together to become one Arrow that describes the entire program, waiting to be executed through the run method, in which we provide dependencies and success, failure and exception handlers.</p><p align="center"><img src="https://miro.medium.com/max/2000/1*rZ43AnqRmRvWxvSvzQzf8Q.png"></p><p align="center"><img src="https://miro.medium.com/max/1000/1*TplQcyUfMnA6RBPk-slaKw.png"><br><em>Running our program with mock and production dependencies</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dependency-injection"></a>Dependency Injection<a aria-hidden="true" tabindex="-1" class="hash-link" href="#dependency-injection" title="Direct link to heading">#</a></h3><p>By delaying execution until the run method is called, Arrows provide a convenient way to perform dependency injection as we can group all the dependencies of the program into a single object type and provide test and production implementations of these in the run method as we wish.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="composability"></a>Composability<a aria-hidden="true" tabindex="-1" class="hash-link" href="#composability" title="Direct link to heading">#</a></h3><p>Arrows are highly composable through their various methods (see <a href="https://lauri3new.github.io/light-arrow-docs/docs/Arrow/#cancellation" target="_blank" rel="noopener noreferrer">documentation</a> for all of them). The orElse and andThen methods are also provided as combinator functions that accept n number of Arrows. orElse can be used for &#x27;horizontal&#x27; composition, such as building up the routes of a express App. andThen can be used for &#x27;vertical&#x27; composition, such as changing the context of a request for example in an authorisation middleware where the user making the requests details are added to the context for use by subsequent middleware. Some more combinators are also included such as retry and repeat.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="performance"></a>Performance<a aria-hidden="true" tabindex="-1" class="hash-link" href="#performance" title="Direct link to heading">#</a></h3><p>Arrows are stack safe and perform similarly to native promises under performance testing, but have all of the benefits listed in this article. Arrows also support <a href="https://lauri3new.github.io/light-arrow-docs/docs/Arrow/#cancellation" target="_blank" rel="noopener noreferrer">cancellation</a> and resource tidy up.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interoperability"></a>Interoperability<a aria-hidden="true" tabindex="-1" class="hash-link" href="#interoperability" title="Direct link to heading">#</a></h3><p>There are a number of helper functions to convert existing types, including basic values, functions, async functions, to Arrows. These are all listed in the <a href="https://lauri3new.github.io/light-arrow-docs/docs/Arrow/#cancellation" target="_blank" rel="noopener noreferrer">documentation</a>.</p><p align="center"><img src="https://miro.medium.com/max/960/0*04NgJRiboqEAjatT"><br><em>Becoming an Arrow Programmer, keeping async code and side effects in check</em></p><p>Light Arrow aims to be a practical library with a small API based around the Arrow data type, so that those using it can get many of the benefits of functional programming without too much overhead in theory. To get started check out the documentation <a href="https://lauri3new.github.io/light-arrow-docs/docs/Arrow" target="_blank" rel="noopener noreferrer">here</a> and install the <a href="https://www.npmjs.com/package/light-arrow" target="_blank" rel="noopener noreferrer">npm module</a>. For those interested in learning more about functional programming I would highly recommend starting with the first few chapters of the excellent book <a href="https://www.oreilly.com/library/view/functional-programming-in/9781617290657/" target="_blank" rel="noopener noreferrer">Functional programming in Scala</a>.</p><p>In Part 2, we will be building a type safe express server using Arrows for routing, middleware and handlers. Thanks for reading, hope to see you next time!</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/light-arrow-docs/blog/tags/light-arrow">light-arrow</a><a class="margin-horiz--sm" href="/light-arrow-docs/blog/tags/functional-programming">functional programming</a><a class="margin-horiz--sm" href="/light-arrow-docs/blog/tags/async">async</a><a class="margin-horiz--sm" href="/light-arrow-docs/blog/tags/io">IO</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/light-arrow-docs/blog/2020/05/25/welcome"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Welcome »</div></a></div></nav></div></div><div class="col col--2"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#originally-published-at-itnextio" class="table-of-contents__link">Originally published at itnext.io</a></li><li><a href="#arrows-and-promises" class="table-of-contents__link">Arrows and Promises</a></li><li><a href="#arrows" class="table-of-contents__link">Arrows</a></li><li><a href="#error-handling" class="table-of-contents__link">Error Handling</a></li><li><a href="#referential-transparency" class="table-of-contents__link">Referential Transparency</a></li><li><a href="#dependency-injection" class="table-of-contents__link">Dependency Injection</a></li><li><a href="#composability" class="table-of-contents__link">Composability</a></li><li><a href="#performance" class="table-of-contents__link">Performance</a></li><li><a href="#interoperability" class="table-of-contents__link">Interoperability</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/light-arrow-docs/docs/Arrow">Arrow</a></li><li class="footer__item"><a class="footer__link-item" href="/light-arrow-docs/docs/HttpApp">express</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Projects</h4><ul class="footer__items"><li class="footer__item"><a href="https://disastercheckin.app/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Disaster Check In App</a></li><li class="footer__item"><a href="https://greatlist.co/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GreatList</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/light-arrow-docs/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/lauri3new/light-arrow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2024 Light Arrow.</div></div></div></footer></div>
<script src="/light-arrow-docs/styles.5b570e1a.js"></script>
<script src="/light-arrow-docs/runtime~main.9af3c1b1.js"></script>
<script src="/light-arrow-docs/main.23c5f3fd.js"></script>
<script src="/light-arrow-docs/1.8252842a.js"></script>
<script src="/light-arrow-docs/2.a74b8244.js"></script>
<script src="/light-arrow-docs/3.80dd5ba5.js"></script>
<script src="/light-arrow-docs/ccc49370.03171d98.js"></script>
<script src="/light-arrow-docs/43b07e0d.ede58c70.js"></script>
<script src="/light-arrow-docs/33c3e163.20790ad5.js"></script>
</body>
</html>